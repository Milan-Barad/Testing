<style>
  .tab-container {
      max-width: 600px;
      margin: 20px auto;
      border: 1px solid #ccc;
  }
  .tab-buttons {
      display: flex;
      border-bottom: 1px solid #ccc;
  }
  .tab-button {
      flex: 1;
      padding: 10px;
      cursor: pointer;
      background: #f4f4f4;
      border: none;
      outline: none;
  }
  .tab-button:hover {
      background: #ddd;
  }
  .tab-content {
      display: none;
      padding: 20px;
  }
  .tab-content.active {
      display: block;
  }
  .accordion {
      width: 100%;
      margin: 10px 0;
  }
  .accordion-item {
      border: 1px solid #ddd;
      margin-bottom: 5px;
  }
  .accordion-header {
      padding: 10px;
      cursor: pointer;
      background: #f4f4f4;
  }
  .accordion-header:hover {
      background: #ddd;
  }
  .accordion-panel {
      padding: 10px;
      display: none;
  }
  .accordion-panel.active {
      display: block;
  }
</style>

<div class="tab-container">
  <div class="tab-buttons">
    {% for block in section.blocks %}
      {% assign tab_id = block.settings.tab_title | handleize %}
      <button class="tab-button" onclick="openTab('{{ tab_id }}')">{{ block.settings.tab_title }}</button>
    {% endfor %}
  </div>

  {% for block in section.blocks %}
    {% assign tab_id = block.settings.tab_title | handleize %}
    <div id="{{ tab_id }}" class="tab-content" style="display: {% if forloop.first %}block{% else %}none{% endif %};">
      <div class="accordion">
        {% for accordion_block in block.settings.accordion_items %}
          {% assign accordion_id = accordion_block.accordion_title | handleize %}
          <div class="accordion-item">
            <div class="accordion-header" onclick="toggleAccordion('{{ accordion_id }}')">{{ accordion_block.accordion_title }}</div>
            <div id="{{ accordion_id }}" class="accordion-panel">
              {{ accordion_block.content }}
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  {% endfor %}
</div>

<script>
  function openTab(tabName) {
    var i, tabContent, tabButtons;
    tabContent = document.getElementsByClassName("tab-content");
    for (i = 0; i < tabContent.length; i++) {
      tabContent[i].style.display = "none";
    }
    tabButtons = document.getElementsByClassName("tab-button");
    for (i = 0; i < tabButtons.length; i++) {
      tabButtons[i].className = tabButtons[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    event.currentTarget.className += " active";
  }

  function toggleAccordion(panelId) {
    var panel = document.getElementById(panelId);
    if (panel.className.indexOf("active") == -1) {
      panel.className += " active";
    } else {
      panel.className = panel.className.replace(" active", "");
    }
  }

  document.getElementsByClassName("tab-button")[0].click();
</script>

{% schema %}
  {
    "name": "PDP Video Section",
    "disabled_on": {
      "groups": ["header", "footer"]
    },
    "settings": [
      {
        "type": "text",
        "id": "title",
        "label": "Title",
        "default": "What is Lorem Ipsum?"
      },
    ],
    "blocks": [
    {
      "type": "text",
      "name": "Video",
      "settings": [
        {
          "type": "text",
          "id": "tab_title",
          "label": "tab_title",
        }
      ]
    },
    {
      "type": "accordion",
      "name": "Accordion",
      "settings": [
        {
          "type": "text",
          "id": "accordion_title",
          "label": "accordion_title",
        },
        {
          "type": "text",
          "id": "content",
          "label": "content",
        }
      ]
    }
  ],
  "presets": [
    {
      "name":"PDP Video Section"
    }
  ]
}
{% endschema %}